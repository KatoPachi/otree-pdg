{% extends "global/Page.html" %}
{% load otree static %}

{% block title %}
    選択：あなたはメンバーPです
{% endblock %}

{% block content %}

<div id="explain">
    現在、あなたは{{ C.ENDOWMENT }}を保有しています。
    <br>
    あなたは{{ C.ENDOWMENT }}のうち何ポイントを同じグループのメンバーDに渡すか決めてください。
    <br>
    <br>
    ただし、メンバーDも{{ C.ENDOWMENT }}を保有しています。
    <br>
    また、メンバーDはあなたから受け取ったポイントのうち <b>{{ dictator_rule }}％</b> をメンバーRに渡します。
    <br>
    <br>
    0から100の間の<b>整数（半角数字）</b>で以下のフォームに入力してください。
</div>

<br>

{% formfields %}
{% next_button %}

<hr>

<div id="calculator">
    <b>計算機</b>
    <br>
    あなたの選択を以下の入力し、「計算する」ボタンを押すと、
    あなたと他２人の最終的なポイントを確認できます。
    <br>
    <br>
    あなたの選択：
    <input maxlength="3" style="width: 50px;" type="text" id="send">
    ポイント（半角数字）をメンバーDに渡す
    <input type="button" value="計算する" onclick="pi()">
    <br>
    <br>
    <table border="1" style="border-collapse: collapse" width="500">
      <tr>
        <th>グループメンバー</th>
        <th>ポイント</th>
      </tr>
      <tr>
        <td>メンバーP（<b>あなた</b>）</td>
        <th><span id="piP">？？</span></th>
      </tr>
      <tr>
        <td>メンバーD</td>
        <th><span id="piD">？？</span></th>
      </tr>
      <tr>
        <td>メンバーR</td>
        <th><span id="piR">？？</span></th>
      </tr>
    </table>
</div>

{% endblock %}

{% block scripts %}

<script type="text/javascript">

    function pi() {
        var multiply = js_vars.x;
        var send = parseInt(document.getElementById("send").value);

        var piP = document.getElementById("piP");
        var cal_piP = 100 - send;
        var cal_piP = Math.round(cal_piP);
        piP.innerText = cal_piP;

        var piD = document.getElementById("piD");
        var cal_piD = 100 - (multiply / 100 - 1) * send;
        var cal_piD = Math.round(cal_piD);
        piD.innerText = cal_piD;

        var piR = document.getElementById("piR");
        var cal_piR = send * multiply/100;
        var cal_piR = Math.round(cal_piR);
        piR.innerText = cal_piR;
    }

</script>

{% endblock %}